$(document).ready(function(e){function n(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),t=n.exec(location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function t(){var e=a();if(-1!==e){var n=e+14,t=m.indexOf("?");return-1===t?m.substring(n):m.substring(n,t)}return""}function a(){return m.indexOf("/search/label/")}function r(){var e=t();return""!==e&&(e="/-/"+e),"/feeds/posts/summary"+e+"?alt=json-in-script&max-results=99999"}function s(){var e="";if(-1!==m.indexOf("?q=")||-1!==m.indexOf("&q=")){var n=-1!==m.indexOf("?q=")?m.substring(m.indexOf("?q=")):m.substring(m.indexOf("&q="));e=-1!==n.indexOf("&")?n.substring(3,n.indexOf("&")):n.substring(3)}return e}function i(e,n){var t=1,a=o();return""!==a&&(t=u(n,a)),t}function u(e,n){for(var t=1,a=0;a<e.feed.entry.length;a++){var r=l(e.feed.entry[a].published.$t);if(n===r){t=c(a+2);break}}return t}function l(e){return e.substring(0,19)+e.substring(23,29)}function o(){var e="",n=m.indexOf("/search?updated-max="),a="/search/label/"+t()+"?updated-max=",r=m.indexOf(a);return(-1!==n||-1!==r)&&(e=f(-1!==n?n+20:r+a.length)),decodeURIComponent(e)}function f(e){var n=m.substring(e,m.length);return-1!==n.indexOf("&")?n.substring(0,n.indexOf("&")):n}function c(e){return Math.ceil(e/P.postPerPage)}function p(e){var n=c(e.feed.entry.length),a=[],r=1;if(1>=n)a.push("/?max-results="+P.postPerPage);else{var s=-1!==m.indexOf("/search/label/");r=i(n,e),s?a.push("/search/label/"+t()+"?max-results="+P.postPerPage):a.push("/?max-results="+P.postPerPage),d(a,n,e,s)}g(a,n,r)}function d(e,n,a,r){for(var s=r?"/search/label/"+t()+"?updated-max=":"/search?updated-max=",i=2;n>=i;++i){var u=(i-1)*P.postPerPage-1;e.push(s+encodeURIComponent(l(a.feed.entry[u].published.$t))+"&max-results="+P.postPerPage)}}function g(e,n,t){var a='<span class="pages">Trang '+t+"/"+n+"</span>",r=Math.floor((P.numOfPages-1)/2),s=P.numOfPages-1-r,i=t-r;0>=i&&(i=1);var u=t+s;u-i<P.numOfPages&&(u=i+P.numOfPages-1),u>n&&(u=n,i=n-P.numOfPages+1),0>=i&&(i=1),i>1&&(a+='<a href="'+e[0]+'">'+P.firstText+"</a>"),t>1&&(a+='<a href="'+e[t-2]+'">'+P.prevText+"</a>");for(var l=i;u>=l;++l)a+=l===t?'<span class="current">'+l+"</span>":'<a href="'+e[l-1]+'">'+l+"</a>";n>t&&(a+='<a href="'+e[t]+'">'+P.nextText+"</a>"),n>u&&(a+='<a href="'+e[n-1]+'">'+P.lastText+"</a>"),$("#pagination").html(a)}function h(e){var n="";n+="<ul>";for(var t=0;x>t;t++){var a=e.feed.entry[t],r=a.title.$t;if("content"in a)var s=a.content.$t;else if("summary"in a)var s=a.summary.$t;else var s="";if(s=s.replace(/<[^>]*>/g,""),s.length<v)var i=s;else{s=s.substring(0,v);var u=s.lastIndexOf(" ");i=s.substring(0,u)+"&#133;"}for(var l=0;l<a.link.length;l++){if("thr$total"in a)var o=a.thr$total.$t+" "+O;else o=Math.floor(2e3*Math.random()+1);if("alternate"==a.link[l].rel){var f=a.link[l].href,c=a.published.$t;if("media$thumbnail"in a)var p=a.media$thumbnail.url;else p="http://lh3.ggpht.com/--Z8SVBQZ4X8/TdDxPVMl_sI/AAAAAAAAAAA/jhAgjCpZtRQ/no-image.png"}}n+="<li>",n+='<img alt="'+r+'" src="'+p+'"/>',n+='<div><a href="'+f+'" title="'+i+'">'+r+"</a></div>","yes"==b&&(n+="<span>"+c.substring(8,10)+"/"+c.substring(5,7)+"/"+c.substring(0,4)+" - "+o+" "+O+"</span>"),n+='<div style="clear:both"></div></li>'}n+="</ul>",$("#recent-post").html(n)}var m=location.href,x=5,v=150,b="yes",O="Bình luận",P={homepageUrl:"http://www.loichucvn.com",postPerPage:n("max-results")||9,numOfPages:5,firstText:"Đầu tiên",lastText:"Cuối cùng",nextText:"»",prevText:"«"},y=function(){var e="";e=-1===m.indexOf("?q=")&&-1===m.indexOf("&q=")?r():"/feeds/posts/summary?alt=json-in-script&max-results=99999&q="+encodeURIComponent(s()),$.ajax({type:"GET",url:P.homepageUrl+e,contentType:"application/json",dataType:"jsonp",success:function(e){p(e)}})},T=function(){$.ajax({type:"GET",url:P.homepageUrl+"/feeds/posts/default?alt=json-in-script&max-results="+x,contentType:"application/json",dataType:"jsonp",success:function(e){h(e)}})};T(),y()});